"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3709],{1808:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var s=t(5893),r=t(1151);const a={id:"solution-deploy-operator",sidebar_position:3,title:"FNCM Operator"},o=void 0,i={id:"Create/Deploy/solution-deploy-operator",title:"FNCM Operator",description:"Deploy Operator",source:"@site/docs/3-Create/Deploy/operator.mdx",sourceDirName:"3-Create/Deploy",slug:"/Create/Deploy/solution-deploy-operator",permalink:"/solution-filenet-aws/Create/Deploy/solution-deploy-operator",draft:!1,unlisted:!1,editUrl:"https://github.com/ibm-client-engineering/solution-filenet-aws/tree/main/packages/create-docusaurus/templates/shared/docs/3-Create/Deploy/operator.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"solution-deploy-operator",sidebar_position:3,title:"FNCM Operator"},sidebar:"tutorialSidebar",previous:{title:"Postgresql",permalink:"/solution-filenet-aws/Create/Deploy/solution-deploy-postgres"},next:{title:"IBM Enterprise Records",permalink:"/solution-filenet-aws/Create/Deploy/solution-deploy-ier"}},c={},d=[{value:"Deploy Operator",id:"deploy-operator",level:2},{value:"Scripted Operator deployment",id:"scripted-operator-deployment",level:3},{value:"Manual Operator deployment",id:"manual-operator-deployment",level:3},{value:"Create the <code>ibm-fncm-secret</code>",id:"create-the-ibm-fncm-secret",level:3},{value:"Create the <code>ibm-ban-secret</code> for Navigator",id:"create-the-ibm-ban-secret-for-navigator",level:3},{value:"Create the <code>ldap-bind-secret</code>",id:"create-the-ldap-bind-secret",level:3},{value:"Deploying CR",id:"deploying-cr",level:2},{value:"Appendix",id:"appendix",level:2},{value:"Upgrading FNCM in the cluster",id:"upgrading-fncm-in-the-cluster",level:3},{value:"Upgrading the operator manually",id:"upgrading-the-operator-manually",level:4},{value:"Upgrading FNCM containers",id:"upgrading-fncm-containers",level:4},{value:"Adding Object Stores",id:"adding-object-stores",level:3},{value:"Adding the entries for <code>dc_os_datasources</code>",id:"adding-the-entries-for-dc_os_datasources",level:4},{value:"Adding the entries for <code>ic_obj_store_creation</code>",id:"adding-the-entries-for-ic_obj_store_creation",level:4},{value:"Adding the entries for <code>ic_icn_init_info</code>",id:"adding-the-entries-for-ic_icn_init_info",level:4},{value:"Apply the CR to the cluster",id:"apply-the-cr-to-the-cluster",level:4},{value:"Enabling Content Search Services",id:"enabling-content-search-services",level:3},{value:"Secret menu items",id:"secret-menu-items",level:3}];function _(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"deploy-operator",children:"Deploy Operator"}),"\n",(0,s.jsxs)(n.p,{children:["Download the IBM Case file for FileNet Content Manager. As of this writing it is ",(0,s.jsx)(n.strong,{children:"v1.8.0"}),". You can check for newer versions by going ",(0,s.jsx)(n.a,{href:"https://github.com/IBM/cloud-pak/tree/master/repo/case/ibm-cp-fncm-case",children:"here"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"wget https://github.com/IBM/cloud-pak/raw/master/repo/case/ibm-cp-fncm-case/1.8.0/ibm-cp-fncm-case-1.8.0.tgz\n"})}),"\n",(0,s.jsx)(n.p,{children:"Extract the case file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"tar zxvf ibm-cp-fncm-case-1.8.0.tgz\n"})}),"\n",(0,s.jsx)(n.p,{children:"Change into the operator directory and extract the container samples file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"cd ibm-cp-fncm-case/inventory/fncmOperator/files/deploy/crs/\n\n// this name is equivalent to the corresponding filenet version and thus may change\ntar xvf container-samples-5.5.12.tar\n"})}),"\n",(0,s.jsx)(n.h3,{id:"scripted-operator-deployment",children:"Scripted Operator deployment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"cd container-samples/scripts\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"filenetvars.sh"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",metastring:'title="filenetvars.sh"',children:'#!/bin/bash\n# set -x\n###############################################################################\n#\n# Licensed Materials - Property of IBM\n#\n# (C) Copyright IBM Corp. 2021. All Rights Reserved.\n#\n# US Government Users Restricted Rights - Use, duplication or\n# disclosure restricted by GSA ADP Schedule Contract with IBM Corp.\n#\n###############################################################################\n\nexport FNCM_PLATFORM="other"\nexport FNCM_NAMESPACE="filenet"\nexport FNCM_LICENSE_ACCEPT="Accept"\nexport FNCM_STORAGE_CLASS="efs-sc"\nexport FNCM_ENTITLEMENT_KEY="<ENTITLEMENT_KEY>"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You can retrieve your entitlement key from this URL:\n",(0,s.jsx)(n.a,{href:"https://myibm.ibm.com/products-services/containerlibrary",children:"https://myibm.ibm.com/products-services/containerlibrary"})]}),"\n",(0,s.jsxs)(n.p,{children:["Source the ",(0,s.jsx)(n.code,{children:"filenetvars.sh"})," file and then run the installation script from that directory:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"source ./filenetvars.sh\n./deployOperator.sh\n"})}),"\n",(0,s.jsx)(n.h3,{id:"manual-operator-deployment",children:"Manual Operator deployment"}),"\n",(0,s.jsx)(n.p,{children:"If you cannot run the deployment script, follow these steps to deploy the operator manually."}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"Available as of 22.0.2-IF004 and greater"}),(0,s.jsxs)(n.p,{children:["If your cluster has resource limits required via cluster policy, you will need to update the ",(0,s.jsx)(n.code,{children:"operator.yaml"})," to set those limits for the operator's init containers."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'      initContainers:\n        - name: folder-prepare-container\n          image: "docker-cotsimage-gts-dev.gslb.thc.travp.net/cpopen/icp4a-content-operator:23.0.1-IF003"\n          securityContext:\n            allowPrivilegeEscalation: false\n            privileged: false\n            readOnlyRootFilesystem: true\n            capabilities:\n              drop:\n              - ALL\n          resources:\n            limits:\n              cpu: "1"\n              memory: "2Gi"\n            requests:\n              cpu: "500m"\n              memory: "512Mi"\n\n'})})]}),"\n",(0,s.jsxs)(n.p,{children:["From the ",(0,s.jsx)(n.code,{children:"container-samples"})," directory:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"cd ibm-cp-fncm-case/inventory/fncmOperator/files/deploy/crs/container-samples\nkubectl apply -f ./descriptors/fncm_v1_fncm_crd.yaml\nkubectl apply -f ./descriptors/service_account.yaml\nkubectl apply -f ./descriptors/role.yaml\nkubectl apply -f ./descriptors/role_binding.yaml\nkubectl apply -f ./descriptors/operator.yaml\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"create-the-ibm-fncm-secret",children:["Create the ",(0,s.jsx)(n.code,{children:"ibm-fncm-secret"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'kubectl create secret generic ibm-fncm-secret \\\n--from-literal=gcdDBUsername="ceuser" \\\n--from-literal=gcdDBPassword="p@ssw0rd" \\\n--from-literal=osDBUsername="ceuser" \\\n--from-literal=osDBPassword="p@ssw0rd" \\\n--from-literal=appLoginUsername="cpadmin" \\\n--from-literal=appLoginPassword="Password" \\\n--from-literal=keystorePassword="p@ssw0rd" \\\n--from-literal=ltpaPassword="p@ssw0rd"\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"create-the-ibm-ban-secret-for-navigator",children:["Create the ",(0,s.jsx)(n.code,{children:"ibm-ban-secret"})," for Navigator"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'kubectl create secret generic ibm-ban-secret \\\n  --from-literal=navigatorDBUsername="ceuser" \\\n  --from-literal=navigatorDBPassword="p@ssw0rd" \\\n  --from-literal=keystorePassword="p@ssw0rd" \\\n  --from-literal=ltpaPassword="p@ssw0rd" \\\n  --from-literal=appLoginUsername="cpadmin" \\\n  --from-literal=appLoginPassword="Password" \\\n  --from-literal=jMailUsername="mailadmin" \\\n  --from-literal=jMailPassword="{xor}GDoxNiosbg=="\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"create-the-ldap-bind-secret",children:["Create the ",(0,s.jsx)(n.code,{children:"ldap-bind-secret"})]}),"\n",(0,s.jsx)(n.p,{children:"Create a secret in the filenet namespace for the ldap-bind secret"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="ldap_secrets.yaml"',children:'kind: Secret\napiVersion: v1\nmetadata:\n  name: ldap-bind-secret\n  namespace: filenet\n  labels:\n    app: filenet-openldap\nstringData:\n  ldapUsername: "cn=admin,dc=filenet,dc=internal"\n  ldapPassword: p@ssw0rd\n  externalLdapUsername: "cn=admin,dc=filenet,dc=internal"\n  externalLdapPassword: p@ssw0rd\n'})}),"\n",(0,s.jsx)(n.p,{children:"Apply it to the cluster"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f ldap_secrets.yaml\n"})}),"\n",(0,s.jsx)(n.h2,{id:"deploying-cr",children:"Deploying CR"}),"\n","\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"A full version of the CR for release 5.5.11 can be found here. It contains a lot of extra settings that are covered in the Appendix below."}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{target:"_blank",href:t(8378).Z+"",children:"ibm_fncm_cr_production-5.5.11.yaml"})}),"\n"]}),(0,s.jsxs)(n.p,{children:["As any file mentioned here, these are reference only. Your best source would be to use the CR that comes with the case file referenced above. It can be found in the ",(0,s.jsx)(n.code,{children:"container-samples"})," tar. That would be the best reference to start with."]})]}),"\n",(0,s.jsx)(n.p,{children:"Here is our example CR as a reference. It would be applied with the following command to the cluster. Make sure you're in your correct namespace or have your namespace context set."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f ibm_fncm_cr_production_abrv.yaml\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="ibm_fncm_cr_production_abrv.yaml"',children:'apiVersion: fncm.ibm.com/v1\nkind: FNCMCluster\nmetadata:\n  name: fncmdeploy\n  labels:\n    app.kubernetes.io/instance: ibm-fncm\n    app.kubernetes.io/managed-by: ibm-fncm\n    app.kubernetes.io/name: ibm-fncm\n    release: 5.5.12\nspec:\n  appVersion: 23.0.2\n  var_setlog_true: false\n  var_navigator_no_log: false\n  var_fncm_no_log: false\n  license:\n    accept: true\n  content_optional_components:\n    cmis: true\n    css: true\n    es: false\n    tm: true\n\n  shared_configuration:\n    sc_service_type: NodePort\n    sc_ingress_enable: true\n# Set the sc_ingress_hostname_alias only if you have an FQDN already.\n    sc_ingress_hostname_alias: "filenet.filenet-east.frwd-labs.link"\n# Set the tls secret name if you have a pre-existing cert already in the cluster or you are using cert-manager.\n    sc_ingress_tls_secret_name: "letsencrypt-filenet-east-prod-cluster-cert"\n    sc_ingress_annotations:\n      - nginx.ingress.kubernetes.io/affinity: cookie\n# Set cert-manager.io/issuer if you\'ve configured cert-manager in your cluster and have set a namespace scoped issuer for it. If you created a cluster-scoped issuer, this would be cert-manager.io/cluster-issuer\n      - cert-manager.io/issuer: "letsencrypt-prod"\n      - nginx.ingress.kubernetes.io/force-ssl-redirect: "true"\n      - nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"\n      - nginx.ingress.kubernetes.io/secure-backends: "true"\n      - nginx.ingress.kubernetes.io/session-cookie-name: route\n      - nginx.ingress.kubernetes.io/session-cookie-hash: sha1\n      - kubernetes.io/ingress.class: nginx\n    no_log: false\n    sc_deployment_context: FNCM\n    image_pull_secrets:\n    - ibm-entitlement-key\n    sc_image_repository: cp.icr.io\n    root_ca_secret: fncm-root-ca\n    sc_deployment_patterns: content\n    sc_deployment_type: production\n    sc_fncm_license_model: "FNCM.PVUNonProd"\n    sc_deployment_profile_size: "medium"\n    sc_run_as_user:\n    sc_deployment_platform: "other"\n    # If you are using an FQDN, set it here for sc_deployment_hostname_suffix. Else comment this.\n    sc_deployment_hostname_suffix: "filenet.filenet-east.frwd-labs.link" \n    trusted_certificate_list: []\n    sc_content_initialization:\n      cpe: true\n      css: false\n      ban: false\n    sc_content_verification: false\n    storage_configuration:\n      sc_slow_file_storage_classname: "efs-sc"\n      sc_medium_file_storage_classname: "efs-sc"\n      sc_fast_file_storage_classname: "efs-sc"\n\n  ldap_configuration:\n  # Our example is actually using OpenLDAP, but this seems to be the only way to get it to work\n    lc_selected_ldap_type: "IBM Security Directory Server"\n    lc_ldap_precheck: true\n  # Should be the cluster-ip of the ldap service\n    lc_ldap_server: "10.100.217.46"\n    lc_ldap_port: "389"\n    lc_bind_secret: ldap-bind-secret\n    lc_ldap_base_dn: "dc=filenet,dc=internal"\n    lc_ldap_ssl_enabled: false\n    lc_ldap_ssl_secret_name: "ldap"\n    #lc_ldap_user_name_attribute: "*:uid"\n    lc_ldap_user_name_attribute: "*:cn"\n    lc_ldap_user_display_name_attr: "cn"\n    lc_ldap_group_base_dn: "ou=Groups,dc=filenet,dc=internal"\n    lc_ldap_group_name_attribute: "*:cn"\n    lc_ldap_group_display_name_attr: "cn"\n    lc_ldap_group_membership_search_filter: "(|(&(objectclass=groupofnames)(member={0}))(&(objectclass=groupofuniquenames)(uniquemember={0})))"\n    lc_ldap_group_member_id_map: "groupofnames:member"\n    tds:\n      lc_user_filter: "(&(cn=%v)(objectclass=inetOrgPerson))"\n      lc_group_filter: "(&(cn=%v)(|(objectclass=groupOfNames)(objectclass=groupofuniquenames)(objectclass=groupofurls)))"\n\n  datasource_configuration:\n    dc_ssl_enabled: false\n    database_precheck: true\n    dc_gcd_datasource:\n      dc_database_type: "postgresql"\n      dc_common_gcd_datasource_name: "FNGCDDS"\n      dc_common_gcd_xa_datasource_name: "FNGCDDSXA"\n  # Should be the cluster-ip of your postgresql service if running postgres in a pod, or the ip of your RDS instance\n      database_servername: "10.100.80.28"\n      database_name: "gcddb"\n      database_port: "5432"\n      database_ssl_secret_name: "<Required>"\n      dc_oracle_gcd_jdbc_url: "<Required>"\n      dc_hadr_validation_timeout: 15\n      dc_hadr_standby_servername: "<Required>"\n      dc_hadr_standby_port: "<Required>"\n      dc_hadr_retry_interval_for_client_reroute: 15\n      dc_hadr_max_retries_for_client_reroute: 3\n    dc_os_datasources:\n    - dc_database_type: "postgresql"\n      dc_os_label: "os"\n      dc_common_os_datasource_name: "FNOS1DS"\n      dc_common_os_xa_datasource_name: "FNOS1DSXA"\n  # Should be the cluster-ip of your postgresql service if running postgres in a pod, or the ip of your RDS instance\n      database_servername: "10.100.80.28"\n      database_name: "osdb"\n      database_port: "5432"\n      database_ssl_secret_name: "<Required>"\n      dc_oracle_os_jdbc_url: "<Required>"\n      dc_hadr_validation_timeout: 15\n      dc_hadr_standby_servername: "<Required>"\n      dc_hadr_standby_port: "<Required>"\n      dc_hadr_retry_interval_for_client_reroute: 15\n      dc_hadr_max_retries_for_client_reroute: 3\n    dc_icn_datasource:\n      dc_database_type: "postgresql"\n      dc_common_icn_datasource_name: "ECMClientDS"\n  # Should be the cluster-ip of your postgresql service if running postgres in a pod, or the ip of your RDS instance\n      database_servername: "10.100.80.28"\n      database_port: "5432"\n      database_name: "icndb"\n      database_ssl_secret_name: "<Required>"\n      dc_oracle_icn_jdbc_url: "<Required>"\n      dc_hadr_validation_timeout: 15\n      dc_hadr_standby_servername: "<Required>"\n      dc_hadr_standby_port: "<Required>"\n      dc_hadr_retry_interval_for_client_reroute: 15\n      dc_hadr_max_retries_for_client_reroute: 3\n  initialize_configuration:\n    ic_ldap_creation:\n      ic_ldap_admin_user_name:\n        - "cpadmin" # user name for P8 domain admin, for example, "CEAdmin".  This parameter accepts a list of values.\n      ic_ldap_admins_groups_name:\n        - "cpadmins" # group name for P8 domain admin, for example, "P8Administrators".  This parameter accepts a list of values.\n      ic_ldap_name: ldap\n    ic_domain_creation:\n      domain_name: "P8DOMAIN"\n      encryption_key: "128"\n    ic_obj_store_creation:\n      object_stores:\n        - oc_cpe_obj_store_display_name: "OS01" # Required display name of the object store, for example, "OS01"\n          oc_cpe_obj_store_symb_name: "OS01" # Required symbolic name of the object store, for example, "OS01"\n          oc_cpe_obj_store_conn:\n            name: "OS01_dbconnection"\n            dc_os_datasource_name: "FNOS1DS" # This value must match with the non-XA datasource name in the "datasource_configuration" above.\n            dc_os_xa_datasource_name: "FNOS1DSXA" # This value must match with the XA datasource name in the "datasource_configuration" above.\n          oc_cpe_obj_store_admin_user_groups:\n            - "cpadmins" # user name and group name for object store admin, for example, "CEAdmin" or "P8Administrators".  This parameter accepts a list of values.\n  ecm_configuration:\n    fncm_secret_name: ibm-fncm-secret\n    route_ingress_annotations:\n    disable_fips: true\n    node_affinity:\n      custom_node_selector_match_expression: [ ]\n    custom_annotations: { }\n    custom_labels: { }\n\n    cpe:\n      arch:\n        amd64: "3 - Most preferred"\n      replica_count: 2\n      image:\n        ## The default repository is the IBM Entitled Registry.\n        repository: cp.icr.io/cp/cp4a/fncm/cpe\n        tag: ga-5512-p8cpe\n        pull_policy: IfNotPresent\n      log:\n       format: json\n      resources:\n        requests:\n          cpu: "500m"\n          memory: "512Mi"\n          ephemeral_storage: "4Gi"\n        limits:\n          cpu: "1"\n          memory: "3072Mi"\n          ephemeral_storage: "4Gi"\n      auto_scaling:\n        enabled: false\n        max_replicas: "<Required>"\n        min_replicas: "<Required>"\n        target_cpu_utilization_percentage: "<Required>"\n      cpe_production_setting:\n        time_zone: Etc/UTC\n        jvm_initial_heap_percentage: 18\n        jvm_max_heap_percentage: 33\n        jvm_customize_options:\n        gcd_jndi_name: FNGCDDS\n        gcd_jndixa_name: FNGCDDSXA\n        # The license must be set to "accept" in order for the component to install.  This is the default value.\n        license: accept\n      monitor_enabled: false\n      logging_enabled: false\n      collectd_enable_plugin_write_graphite: false\n      datavolume:\n        existing_pvc_for_cpe_cfgstore: \n          name: "cpe-cfgstore"\n          size: 1Gi\n        existing_pvc_for_cpe_logstore: \n          name: "cpe-logstore"\n          size: 1Gi\n        existing_pvc_for_cpe_filestore: \n          name: "cpe-filestore"\n          size: 1Gi\n        existing_pvc_for_cpe_icmrulestore: \n          name: "cpe-icmrulesstore"\n          size: 1Gi\n        existing_pvc_for_cpe_textextstore: \n          name: "cpe-textextstore"\n          size: 1Gi\n        existing_pvc_for_cpe_bootstrapstore: \n          name: "cpe-bootstrapstore"\n          size: 1Gi\n        existing_pvc_for_cpe_fnlogstore: \n          name: "cpe-fnlogstore"\n          size: 1Gi\n      probe:\n        startup:\n          initial_delay_seconds: 120\n          period_seconds: 30\n          timeout_seconds: 10\n          failure_threshold: 16\n        readiness:\n          period_seconds: 30\n          timeout_seconds: 10\n          failure_threshold: 6\n        liveness:\n          period_seconds: 30\n          timeout_seconds: 5\n          failure_threshold: 6\n      ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n      image_pull_secrets:\n        name: "ibm-entitlement-key"\n\n    css:\n      arch:\n        amd64: "3 - Most preferred"\n      replica_count: 2\n      image:\n        ## The default repository is the IBM Entitled Registry.\n        repository: cp.icr.io/cp/cp4a/fncm/css\n        tag: ga-5512-p8css\n        pull_policy: IfNotPresent\n      log:\n        format: json\n      resources:\n        requests:\n          cpu: "500m"\n          memory: "512Mi"\n          ephemeral_storage: "500Mi"\n        limits:\n          cpu: "1"\n          memory: "4096Mi"\n          ephemeral_storage: "1.5Gi"\n      css_production_setting:\n        jvm_max_heap_percentage: 50\n        license: accept\n        icc:\n          icc_enabled: false\n          icc_secret_name: "ibm-icc-secret"\n          p8domain_name: "P8DOMAIN"\n          secret_masterkey_name: "icc-masterkey-txt"\n      monitor_enabled: false\n      logging_enabled: false\n      collectd_enable_plugin_write_graphite: false\n      datavolume:\n        existing_pvc_for_css_cfgstore: \n          name: "css-cfgstore"\n          size: 1Gi\n        existing_pvc_for_css_logstore: \n          name: "css-logstore"\n          size: 1Gi\n        existing_pvc_for_css_tmpstore: \n          name: "css-tempstore"\n          size: 1Gi\n        existing_pvc_for_index: \n          name: "css-indexstore"\n          size: 1Gi\n        existing_pvc_for_css_customstore: \n          name: "css-customstore"\n          size: 1Gi\n      probe:\n        startup:\n          initial_delay_seconds: 60\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        readiness:\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        liveness:\n          period_seconds: 10\n          timeout_seconds: 5\n          failure_threshold: 6\n      ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n      image_pull_secrets:\n        name: "ibm-entitlement-key"\n\n    cmis:\n      arch:\n        amd64: "3 - Most preferred"\n      replica_count: 2\n      image:\n        ## The default repository is the IBM Entitled Registry.\n        repository: cp.icr.io/cp/cp4a/fncm/cmis\n        tag: ga-307-cmis-if004\n        pull_policy: IfNotPresent\n      log:\n        format: json\n      resources:\n        requests:\n          cpu: "500m"\n          memory: "256Mi"\n          ephemeral_storage: "1Gi"\n        limits:\n          cpu: "1"\n          memory: "1536Mi"\n          ephemeral_storage: "1Gi"\n      auto_scaling:\n        enabled: false\n        max_replicas: "<Required>"\n        min_replicas: "<Required>"\n        target_cpu_utilization_percentage: "<Required>"\n      cmis_production_setting:\n        cpe_url:\n        time_zone: Etc/UTC\n        jvm_initial_heap_percentage: 40\n        jvm_max_heap_percentage: 66\n        jvm_customize_options:\n        ws_security_enabled: false\n        checkout_copycontent: true\n        default_maxitems: 25\n        cvl_cache: true\n        secure_metadata_cache: false\n        filter_hidden_properties: true\n        querytime_limit: 180\n        resumable_queries_forrest: true\n        escape_unsafe_string_characters: false\n        max_soap_size: 180\n        print_pull_stacktrace: false\n        folder_first_search: false\n        ignore_root_documents: false\n        supporting_type_mutability: false\n        license: accept\n      monitor_enabled: false\n      logging_enabled: false\n      collectd_enable_plugin_write_graphite: false\n      datavolume:\n        existing_pvc_for_cmis_cfgstore: \n          name: "cmis-cfgstore"\n          size: 1Gi\n        existing_pvc_for_cmis_logstore: \n          name: "cmis-logstore"\n          size: 1Gi\n      probe:\n        startup:\n          initial_delay_seconds: 90\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        readiness:\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        liveness:\n          period_seconds: 10\n          timeout_seconds: 5\n          failure_threshold: 6\n      ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n      image_pull_secrets:\n        name: "ibm-entitlement-key"\n\n    graphql:\n      arch:\n        amd64: "3 - Most preferred"\n      replica_count: 2\n      image:\n        ## The default repository is the IBM Entitled Registry.\n        repository: cp.icr.io/cp/cp4a/fncm/graphql\n        tag: ga-5512-p8cgql\n        pull_policy: IfNotPresent\n      log:\n        format: json\n      resources:\n        requests:\n          cpu: "500m"\n          memory: "512Mi"\n          ephemeral_storage: "1Gi"\n        limits:\n          cpu: "1"\n          memory: "1536Mi"\n          ephemeral_storage: "1Gi"\n      auto_scaling:\n        enabled: false\n        max_replicas: "<Required>"\n        min_replicas: "<Required>"\n        target_cpu_utilization_percentage: "<Required>"\n      graphql_production_setting:\n        time_zone: Etc/UTC\n        jvm_initial_heap_percentage: 40\n        jvm_max_heap_percentage: 66\n        jvm_customize_options:\n        license_model: FNCM.PVUNonProd\n        license: accept\n        enable_graph_iql: false\n      monitor_enabled: false\n      logging_enabled: false\n      collectd_enable_plugin_write_graphite: false\n      datavolume:\n        existing_pvc_for_graphql_cfgstore: \n          name: "graphql-cfgstore"\n          size: 1Gi\n        existing_pvc_for_graphql_logstore: \n          name: "graphql-logstore"\n          size: 1Gi\n      probe:\n        startup:\n          initial_delay_seconds: 120\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        readiness:\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        liveness:\n          period_seconds: 10\n          timeout_seconds: 5\n          failure_threshold: 6\n      ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n      image_pull_secrets:\n        name: "ibm-entitlement-key"\n\n    es:\n      arch:\n        amd64: "3 - Most preferred"\n      replica_count: 2\n      image:\n        ## The default repository is the IBM Entitled Registry.\n        repository: cp.icr.io/cp/cp4a/fncm/extshare\n        tag: ga-3015-es\n        pull_policy: IfNotPresent\n      resources:\n        requests:\n          cpu: "500m"\n          memory: "512Mi"\n          ephemeral_storage: "1Gi"\n        limits:\n          cpu: "1"\n          memory: "1536Mi"\n          ephemeral_storage: "1Gi"\n      auto_scaling:\n        enabled: false\n        max_replicas: "<Required>"\n        min_replicas: "<Required>"\n        target_cpu_utilization_percentage: "<Required>"\n      es_production_setting:\n        time_zone: Etc/UTC\n        jvm_initial_heap_percentage: 40\n        jvm_max_heap_percentage: 66\n        jvm_customize_options:\n        license_model: FNCM.PVUNonProd\n        license: accept\n        allowed_origins:\n      monitor_enabled: false\n      logging_enabled: false\n      collectd_enable_plugin_write_graphite: false\n      datavolume:\n        existing_pvc_for_es_cfgstore: \n          name: "es-cfgstore"\n          size: 1Gi\n        existing_pvc_for_es_logstore: \n          name: "es-logstore"\n          size: 1Gi\n      probe:\n        startup:\n          initial_delay_seconds: 180\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        readiness:\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        liveness:\n          period_seconds: 10\n          timeout_seconds: 5\n          failure_threshold: 6\n      ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n      image_pull_secrets:\n        name: "ibm-entitlement-key"\n\n    tm:\n      arch:\n        amd64: "3 - Most preferred"\n      replica_count: 2\n      image:\n        ## The default repository is the IBM Entitled Registry.\n        repository: cp.icr.io/cp/cp4a/fncm/taskmgr\n        tag: ga-3015-tm\n        pull_policy: IfNotPresent\n      resources:\n        requests:\n          cpu: "500m"\n          memory: "512Mi"\n          ephemeral_storage: "1Gi"\n        limits:\n          cpu: "1"\n          memory: "1536Mi"\n          ephemeral_storage: "1Gi"\n      auto_scaling:\n        enabled: false\n        max_replicas: "<Required>"\n        min_replicas: "<Required>"\n        target_cpu_utilization_percentage: "<Required>"\n      tm_production_setting:\n        time_zone: Etc/UTC\n        jvm_initial_heap_percentage: 40\n        jvm_max_heap_percentage: 66\n        jvm_customize_options: "-Dcom.ibm.ecm.task.StartUpListener.defaultLogLevel=FINE"\n        license: accept\n        security_roles_to_group_mapping:\n           task_admins:\n             groups: [cpadmin]\n             users: []\n           task_users:\n             groups: [cpusers]\n             users: []\n           task_auditors:\n             groups: [cpadmin]\n             users: []\n      monitor_enabled: false\n      logging_enabled: false\n      collectd_enable_plugin_write_graphite: false\n      datavolume:\n        existing_pvc_for_tm_cfgstore: \n          name: "tm-cfgstore"\n          size: 1Gi\n        existing_pvc_for_tm_logstore: \n          name: "tm-logstore"\n          size: 1Gi\n        existing_pvc_for_tm_pluginstore: \n          name: "tm-pluginstore"\n          size: 1Gi\n      probe:\n        startup:\n          initial_delay_seconds: 120\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        readiness:\n          period_seconds: 10\n          timeout_seconds: 10\n          failure_threshold: 6\n        liveness:\n          period_seconds: 10\n          timeout_seconds: 5\n          failure_threshold: 6\n      ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n      image_pull_secrets:\n        name: "ibm-entitlement-key"\n\n  navigator_configuration:\n    ban_secret_name: ibm-ban-secret\n    arch:\n      amd64: "3 - Most preferred"\n    replica_count: 2\n    image:\n      ## The default repository is the IBM Entitled Registry\n      repository: cp.icr.io/cp/cp4a/ban/navigator\n      tag: ga-3015-icn\n      pull_policy: IfNotPresent\n    log:\n      format: json\n    resources:\n      requests:\n        cpu: "500m"\n        memory: "512Mi"\n        ephemeral_storage: "1Gi"\n      limits:\n        cpu: "1"\n        memory: "3072Mi"\n        ephemeral_storage: "2.5Gi"\n      auto_scaling:\n        enabled: false\n        max_replicas: "<Required>"\n        min_replicas: "<Required>"\n        target_cpu_utilization_percentage: "<Required>"\n    node_affinity:\n      custom_node_selector_match_expression: [ ]\n    custom_annotations: { }\n    custom_labels: { }\n    java_mail:\n      host: "fncm-exchange1.ibm.com"\n      port: "25"\n      sender: "MailAdmin@fncmexchange.com"\n      ssl_enabled: false\n    disable_fips: true\n    icn_production_setting:\n      timezone: Etc/UTC\n      gdfontpath: "/opt/ibm/java/jre/lib/fonts"\n      jvm_initial_heap_percentage: 40\n      jvm_max_heap_percentage: 66\n      jvm_customize_options:\n      icn_jndids_name: ECMClientDS\n      icn_schema: ICNDB\n      icn_table_space: ICNDB\n      allow_remote_plugins_via_http: false\n    monitor_enabled: false\n    logging_enabled: false\n    datavolume:\n      existing_pvc_for_icn_cfgstore: \n        name: "icn-cfgstore"\n        size: 1Gi\n      existing_pvc_for_icn_logstore: \n        name: "icn-logstore"\n        size: 1Gi\n      existing_pvc_for_icn_pluginstore: \n        name: "icn-pluginstore"\n        size: 1Gi\n      existing_pvc_for_icnvw_cachestore: \n        name: "icn-vw-cachestore"\n        size: 1Gi\n      existing_pvc_for_icnvw_logstore: \n        name: "icn-vw-logstore"\n        size: 1Gi\n      existing_pvc_for_icn_aspera: \n        name: "icn-asperastore" \n        size: 1Gi\n    probe:\n      startup:\n        initial_delay_seconds: 120\n        period_seconds: 10\n        timeout_seconds: 10\n        failure_threshold: 6\n      readiness:\n        period_seconds: 10\n        timeout_seconds: 10\n        failure_threshold: 6\n      liveness:\n        period_seconds: 10\n        timeout_seconds: 5\n        failure_threshold: 6\n    ## Only use this parameter if you want to override the image_pull_secrets setting in the shared_configuration above.\n    image_pull_secrets:\n      name: "ibm-entitlement-key"\n\n    ## Optional entry only if you have the open_id_connect_providers enabled.\n    ## if not specified it will be set to false.\n    ## Enabling this will give the user the option to sign-in using the LDAP.\n    #enable_ldap: true\n'})}),"\n",(0,s.jsx)(n.h2,{id:"appendix",children:"Appendix"}),"\n",(0,s.jsx)(n.h3,{id:"upgrading-fncm-in-the-cluster",children:"Upgrading FNCM in the cluster"}),"\n",(0,s.jsx)(n.p,{children:"This assumes you are running a version older than v1.8.0."}),"\n",(0,s.jsxs)(n.p,{children:["Download the most recent IBM Case file for FileNet Content Manager. As of this writing it is v1.8.0. You can check for newer versions by going ",(0,s.jsx)(n.a,{href:"https://github.com/IBM/cloud-pak/tree/master/repo/case/ibm-cp-fncm-case",children:"here"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"wget https://github.com/IBM/cloud-pak/raw/master/repo/case/ibm-cp-fncm-case/1.8.0/ibm-cp-fncm-case-1.8.0.tgz\n"})}),"\n",(0,s.jsx)(n.p,{children:"Extract the case file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"tar zxvf ibm-cp-fncm-case-1.8.0.tgz\n"})}),"\n",(0,s.jsx)(n.p,{children:"Change into the operator directory and extract the container samples file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"cd ibm-cp-fncm-case/inventory/fncmOperator/files/deploy/crs/\n\n// this name is equivalent to the corresponding filenet version and thus may change\ntar xvf container-samples-5.5.12.tar\n"})}),"\n",(0,s.jsx)(n.h4,{id:"upgrading-the-operator-manually",children:"Upgrading the operator manually"}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsxs)(n.p,{children:["It's important to note that if you are running airgapped and you have already staged the operator image to your repository, you will need to update the image path in the ",(0,s.jsx)(n.code,{children:"operator.yaml"})," file. The below example uses ",(0,s.jsx)(n.code,{children:"sed"})," and updates every ",(0,s.jsx)(n.code,{children:"image:"})," entry."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'sed -i "s/image:.*/image: \\"<REPO URL>\\/path\\/to\\/icp4a-content-operator:23.0.2\\"/" operator.yaml\n'})}),(0,s.jsxs)(n.p,{children:["This needs to be done ",(0,s.jsx)(n.strong,{children:"before"})," applying the ",(0,s.jsx)(n.code,{children:"operator.yaml"}),"!"]})]}),"\n",(0,s.jsx)(n.p,{children:"If you cannot run the deployment script, follow these steps to deploy the operator manually."}),"\n",(0,s.jsxs)(n.p,{children:["From the ",(0,s.jsx)(n.code,{children:"container-samples"})," directory:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"cd ibm-cp-fncm-case/inventory/fncmOperator/files/deploy/crs/container-samples\nkubectl apply -f ./descriptors/operator.yaml\n"})}),"\n",(0,s.jsx)(n.p,{children:"Wait for the operator to come back online after upgrading and completes its reconciliation."}),"\n",(0,s.jsx)(n.h4,{id:"upgrading-fncm-containers",children:"Upgrading FNCM containers"}),"\n",(0,s.jsx)(n.p,{children:"Once the operator has been upgraded, update your CR file to the latest image tags. You can also grab the latest CR from the case directory you extracted above:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cd ibm-cp-fncm-case/inventory/fncmOperator/files/deploy/crs/container-samples/descriptors/ibm_fncm_cr_production_FC_content.yaml\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now apply your updated CR to the cluster:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"kubectl apply -f ibm_fncm_cr_production.yaml\n"})}),"\n",(0,s.jsx)(n.h3,{id:"adding-object-stores",children:"Adding Object Stores"}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"This presumes the following:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"You already have the FNCM Operator deployed and running."}),"\n",(0,s.jsxs)(n.li,{children:["You already have Postgres deployed and running per this ",(0,s.jsx)(n.a,{href:"/solution-filenet-aws/Create/Deploy/solution-deploy-postgres",children:"link"})]}),"\n",(0,s.jsxs)(n.li,{children:["You have already created the required databases for the object stores as referenced in the Appendix ",(0,s.jsx)(n.a,{href:"/solution-filenet-aws/Create/Deploy/solution-deploy-postgres",children:"here"})]}),"\n"]})]}),"\n",(0,s.jsxs)(n.admonition,{title:"Super Important!",type:"note",children:[(0,s.jsx)(n.p,{children:"Important to note:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'    dc_common_os_datasource_name: "FNOS1DS"\n    dc_common_os_xa_datasource_name: "FNOS1DSXA"\n'})}),(0,s.jsx)(n.p,{children:"The above need to be unique to each object store. For our example we will be incrementing them."})]}),"\n",(0,s.jsxs)(n.h4,{id:"adding-the-entries-for-dc_os_datasources",children:["Adding the entries for ",(0,s.jsx)(n.code,{children:"dc_os_datasources"})]}),"\n",(0,s.jsxs)(n.p,{children:["In your CR file you will need to add the following entries. First find your ",(0,s.jsx)(n.code,{children:"dc_os_datasources"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'// highlight-next-line\n    dc_os_datasources:\n      ## Provide the database type from your infrastructure.  The possible values are "db2" or "db2HADR" or "oracle" or "sqlserver" or "postgresql".  This should be the same as the\n      ## GCD configuration above.\n      - dc_database_type: "postgresql"\n        ## Provide the object store label for the object store.  The default value is "os" or not defined.\n        ## This label must match the OS secret you define in ibm-fncm-secret.\n        ## For example, if you define dc_os_label: "abc", then your OS secret must be defined as:\n        ## --from-literal=abcDBUsername="<your os db username>" --from-literal=abcDBPassword="<your os db password>"\n        ## If you don\'t define dc_os_label, then your secret will be defined as:\n        ## --from-literal=osDBUsername="<your os db username>" --from-literal=osDBPassword="<your os db password>".\n        ## If you have multiple object stores, then you need to define multiple datasource sections starting\n        ## at "dc_database_type" element.\n        ## If all the object store databases share the same username and password, then dc_os_label value should be the same\n        ## in all the datasource sections.\n        dc_os_label: "os"\n        ## The OS1 non-XA datasource name.  The default value is "FNOS1DS".\n        dc_common_os_datasource_name: "FNOS1DS"\n        ## The OS1 XA datasource name.  The default value is "FNOS1DSXA".\n        dc_common_os_xa_datasource_name: "FNOS1DSXA"\n        ## Provide the database server name or IP address of the database server.  This should be the same as the\n        ## GCD configuration above.\n        database_servername: "10.233.50.151"\n        ## Provide the name of the database for the object store 1 for CPE.  For example: "OS1DB"\n        database_name: "osdb"\n        ## Provide the database server port.  For Db2, the default is "50000".  For Oracle, the default is "1521"\n        database_port: "5432"\n        ## The name of the secret that contains the DB2/Oracle/PostgreSQL/SQLServer SSL certificate.\n        database_ssl_secret_name: "<Required>"\n        ## If the database type is Oracle, provide the Oracle DB connection string.  For example, "jdbc:oracle:thin:@//<oracle_server>:1521/orcl"\n        dc_oracle_os_jdbc_url: "<Required>"\n        ## Provide the validation timeout.  If not preference, keep the default value.\n        dc_hadr_validation_timeout: 15\n        ######################################################################################\n        ## If the database type is "Db2HADR", then complete the rest of the parameters below.\n        ## Otherwise, remove or comment out the rest of the parameters below.\n        ######################################################################################\n        dc_hadr_standby_servername: "<Required>"\n        ## Provide the standby database server port.  For Db2, the default is "50000".\n        dc_hadr_standby_port: "<Required>"\n        ## Provide the retry internal.  If not preference, keep the default value.\n        dc_hadr_retry_interval_for_client_reroute: 15\n        ## Provide the max # of retries.  If not preference, keep the default value.\n        dc_hadr_max_retries_for_client_reroute: 3\n'})}),"\n",(0,s.jsx)(n.p,{children:"There's a lot of stuff going on there with the comments, but it boils down to this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'    dc_os_datasources:\n      - dc_database_type: "postgresql"\n        dc_os_label: "os"\n        dc_common_os_datasource_name: "FNOS1DS"\n        dc_common_os_xa_datasource_name: "FNOS1DSXA"\n        database_servername: "172.21.23.244"\n        database_name: "osdb"\n        database_port: "5432"\n        database_ssl_secret_name: "<Required>"\n        dc_oracle_os_jdbc_url: "<Required>"\n        dc_hadr_validation_timeout: 15\n        dc_hadr_standby_servername: "<Required>"\n        dc_hadr_standby_port: "<Required>"\n        dc_hadr_retry_interval_for_client_reroute: 15\n        dc_hadr_max_retries_for_client_reroute: 3\n'})}),"\n",(0,s.jsx)(n.p,{children:"Above is the entry for the intial object store we created when first deploying the operator. The full breakdown of the fields are in the comments above."}),"\n",(0,s.jsx)(n.p,{children:"What we care about for this task is the following:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"database_servername"})," - this should be the same as the other entries. It will be the internal ip address of the postgres service. It can also be the service name as well."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"database_name"})," - this will be the name of one of the new databases we created as part of the tasks in the postgres appendix."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["So adding the new object store databases we created would look like this. As noted, we are incrementing both ",(0,s.jsx)(n.code,{children:"dc_common_os_datasource_name"})," and ",(0,s.jsx)(n.code,{children:"dc_common_os_xa_datasource_name"})," to keep them unique for each object store."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'      - dc_database_type: "postgresql"\n        dc_os_label: "os"\n        dc_common_os_datasource_name: "FNOS1DS2"\n        dc_common_os_xa_datasource_name: "FNOS1DSXA2"\n        database_servername: "172.21.23.244"\n        database_name: "os2db"\n        database_port: "5432"\n        database_ssl_secret_name: "<Required>"\n        dc_oracle_os_jdbc_url: "<Required>"\n        dc_hadr_validation_timeout: 15\n        dc_hadr_standby_servername: "<Required>"\n        dc_hadr_standby_port: "<Required>"\n        dc_hadr_retry_interval_for_client_reroute: 15\n        dc_hadr_max_retries_for_client_reroute: 3\n      - dc_database_type: "postgresql"\n        dc_os_label: "os"\n        dc_common_os_datasource_name: "FNOS1DS3"\n        dc_common_os_xa_datasource_name: "FNOS1DSXA3"\n        database_servername: "172.21.23.244"\n        database_name: "os3db"\n        database_port: "5432"\n        database_ssl_secret_name: "<Required>"\n        dc_oracle_os_jdbc_url: "<Required>"\n        dc_hadr_validation_timeout: 15\n        dc_hadr_standby_servername: "<Required>"\n        dc_hadr_standby_port: "<Required>"\n        dc_hadr_retry_interval_for_client_reroute: 15\n        dc_hadr_max_retries_for_client_reroute: 3\n      - dc_database_type: "postgresql"\n        dc_os_label: "os"\n        dc_common_os_datasource_name: "FNOS1DS4"\n        dc_common_os_xa_datasource_name: "FNOS1DSXA4"\n        database_servername: "172.21.23.244"\n        database_name: "fposdb"\n        database_port: "5432"\n        database_ssl_secret_name: "<Required>"\n        dc_oracle_os_jdbc_url: "<Required>"\n        dc_hadr_validation_timeout: 15\n        dc_hadr_standby_servername: "<Required>"\n        dc_hadr_standby_port: "<Required>"\n        dc_hadr_retry_interval_for_client_reroute: 15\n        dc_hadr_max_retries_for_client_reroute: 3\n      - dc_database_type: "postgresql"\n        dc_os_label: "os"\n        dc_common_os_datasource_name: "FNOS1DS5"\n        dc_common_os_xa_datasource_name: "FNOS1DSXA5"\n        database_servername: "172.21.23.244"\n        database_name: "rosdb"\n        database_port: "5432"\n        database_ssl_secret_name: "<Required>"\n        dc_oracle_os_jdbc_url: "<Required>"\n        dc_hadr_validation_timeout: 15\n        dc_hadr_standby_servername: "<Required>"\n        dc_hadr_standby_port: "<Required>"\n        dc_hadr_retry_interval_for_client_reroute: 15\n        dc_hadr_max_retries_for_client_reroute: 3\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"adding-the-entries-for-ic_obj_store_creation",children:["Adding the entries for ",(0,s.jsx)(n.code,{children:"ic_obj_store_creation"})]}),"\n",(0,s.jsxs)(n.p,{children:["With that added, we now need to skip down to the object store creation entry ",(0,s.jsx)(n.code,{children:"ic_obj_store_creation"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'    ic_obj_store_creation:\n      object_stores:\n        - oc_cpe_obj_store_display_name: "OS01" # Required display name of the object store, for example, "OS01"\n          oc_cpe_obj_store_symb_name: "OS01" # Required symbolic name of the object store, for example, "OS01"\n          oc_cpe_obj_store_conn:\n            name: "OS01_dbconnection"\n            dc_os_datasource_name: "FNOS1DS" # This value must match with the non-XA datasource name in the "datasource_configuration" above.\n            dc_os_xa_datasource_name: "FNOS1DSXA" # This value must match with the XA datasource name in the "datasource_configuration" above.\n          oc_cpe_obj_store_admin_user_groups:\n            - "cpadmins" # user name and group name for object store admin, for example, "CEAdmin" or "P8Administrators".  This parameter accepts a list of values.\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Above we see the initial object store we created when we first applied the CR. We need to add more entries under this. Take note that the ",(0,s.jsx)(n.code,{children:"dc_os_datasource_name"})," and the ",(0,s.jsx)(n.code,{children:"dc_os_xa_datasource_name"})," match each entry in ",(0,s.jsx)(n.code,{children:"dc_os_datasources"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'        - oc_cpe_obj_store_display_name: "OS02"\n          oc_cpe_obj_store_symb_name: "OS02"\n          oc_cpe_obj_store_conn:\n            name: "OS02_dbconnection"\n            dc_os_datasource_name: "FNOS1DS2" # This value must match with the non-XA datasource name in the "datasource_configuration" above.\n            dc_os_xa_datasource_name: "FNOS1DSXA2" # This value must match with the XA datasource name in the "datasource_configuration" above.\n          oc_cpe_obj_store_admin_user_groups:\n            - "cpadmins"\n            - "cpadmin"\n        - oc_cpe_obj_store_display_name: "OS03"\n          oc_cpe_obj_store_symb_name: "OS03"\n          oc_cpe_obj_store_conn:\n            name: "OS03_dbconnection"\n            dc_os_datasource_name: "FNOS1DS3" \n            dc_os_xa_datasource_name: "FNOS1DSXA3"\n          oc_cpe_obj_store_admin_user_groups:\n            - "cpadmins" \n            - "cpadmin"\n        - oc_cpe_obj_store_display_name: "FPOS"\n          oc_cpe_obj_store_symb_name: "FPOS"\n          oc_cpe_obj_store_conn:\n            name: "FPOS_dbconnection"\n            dc_os_datasource_name: "FNOS1DS4" \n            dc_os_xa_datasource_name: "FNOS1DSXA4" \n          oc_cpe_obj_store_admin_user_groups:\n            - "cpadmins" \n            - "cpadmin"\n        - oc_cpe_obj_store_display_name: "ROS"\n          oc_cpe_obj_store_symb_name: "ROS"\n          oc_cpe_obj_store_conn:\n            name: "ROS_dbconnection"\n            dc_os_datasource_name: "FNOS1DS5"\n            dc_os_xa_datasource_name: "FNOS1DSXA5"\n          oc_cpe_obj_store_admin_user_groups:\n            - "cpadmins" \n            - "cpadmin"\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"adding-the-entries-for-ic_icn_init_info",children:["Adding the entries for ",(0,s.jsx)(n.code,{children:"ic_icn_init_info"})]}),"\n",(0,s.jsxs)(n.p,{children:["Now we need to create the repos in the CR and enable the workflows. Search down in the CR for ",(0,s.jsx)(n.code,{children:"ic_icn_init_info"}),"."]}),"\n",(0,s.jsxs)(n.admonition,{title:"Super Important!",type:"note",children:[(0,s.jsxs)(n.p,{children:["As of 5.5.11, the ",(0,s.jsx)(n.code,{children:"add_repo_ce_wsi_url"})," changed to an https url. This is important to note on upgrades from 5.5.10 or lower."]}),(0,s.jsx)(n.p,{children:"Previously it was"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'          add_repo_ce_wsi_url: "http://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9080/wsi/FNCEWS40MTOM/"\n'})}),(0,s.jsx)(n.p,{children:"and now it is"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n'})}),(0,s.jsx)(n.p,{children:"This appendice assumes 5.5.11."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'    ic_icn_init_info\n      icn_repos:\n        - add_repo_id: "OS01repo"\n          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n          add_repo_os_sym_name: "OS01"\n          add_repo_os_dis_name: "OS01"\n          add_repo_workflow_enable: false\n          add_repo_work_conn_pnt: "pe_conn_os1:1"\n          add_repo_protocol: "FileNetP8WSI"\n'})}),"\n",(0,s.jsx)(n.p,{children:"Let's add the new object stores here. We are defining the following unique attributes for each object store:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"add_repo_id"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"add_repo_os_sym_name"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"add_repo_os_dis_name"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"add_repo_work_conn_pnt"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Also for these object stores we want to enable workflows. It's ok to leave it off for ",(0,s.jsx)(n.code,{children:"OS01repo"}),", but the new ones we are adding require it."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"add_repo_workflow_enable: true"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'    ic_icn_init_info\n      icn_repos:\n        - add_repo_id: "OS01repo"\n          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n          add_repo_os_sym_name: "OS01"\n          add_repo_os_dis_name: "OS01"\n          add_repo_workflow_enable: false\n          add_repo_work_conn_pnt: "pe_conn_os1:1"\n          add_repo_protocol: "FileNetP8WSI"\n        - add_repo_id: "OS02repo"\n          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n          add_repo_os_sym_name: "OS02"\n          add_repo_os_dis_name: "OS02"\n          add_repo_workflow_enable: true\n          add_repo_work_conn_pnt: "pe_conn_os2:1"\n          add_repo_protocol: "FileNetP8WSI"\n        - add_repo_id: "OS03repo"\n          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n          add_repo_os_sym_name: "OS03"\n          add_repo_os_dis_name: "OS03"\n          add_repo_workflow_enable: true\n          add_repo_work_conn_pnt: "pe_conn_os3:1"\n          add_repo_protocol: "FileNetP8WSI"\n        - add_repo_id: "FPOSrepo"\n          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n          add_repo_os_sym_name: "FPOS"\n          add_repo_os_dis_name: "FPOS"\n          add_repo_workflow_enable: true\n          add_repo_work_conn_pnt: "pe_conn_fpos1:1"\n          add_repo_protocol: "FileNetP8WSI"\n        - add_repo_id: "ROSrepo"\n          add_repo_ce_wsi_url: "https://{{ meta.name }}-cpe-stateless-svc.{{ meta.namespace }}.svc:9443/wsi/FNCEWS40MTOM/"\n          add_repo_os_sym_name: "ROS"\n          add_repo_os_dis_name: "ROS"\n          add_repo_workflow_enable: true\n          add_repo_work_conn_pnt: "pe_conn_ros1:1"\n          add_repo_protocol: "FileNetP8WSI"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"apply-the-cr-to-the-cluster",children:"Apply the CR to the cluster"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"kubectl apply -f ibm_fncm_cr_production_abrv.yaml\n"})}),"\n",(0,s.jsx)(n.p,{children:"The initialization of the object stores will take some time, but will ultimately be observable via the ACCE web ui."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://zenhub.ibm.com/images/58adc1fd5a3922f84995d86b/42ab81b8-568b-4e6d-9113-e26a5cdcf66d",alt:"ACCE"})}),"\n",(0,s.jsx)(n.h3,{id:"enabling-content-search-services",children:"Enabling Content Search Services"}),"\n",(0,s.jsxs)(n.p,{children:["Initialize and configure CSS by editing the CR. Open it up and find ",(0,s.jsx)(n.code,{children:"initialize_configuration"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"  initialize_configuration:\n    ic_css_creation:\n    - affinity_group_name: <affinity_group_name>\n      css_site_name: <css_site_name>\n      css_text_search_server_credential: RNUNEWc=\n      css_text_search_server_host: '{{ meta.name }}-css-name-number.{{ meta.namespace }}.svc'\n      css_text_search_server_mode: 0\n      css_text_search_server_name: '{{ meta.name }}-css-1'\n      css_text_search_server_port: 8199\n      css_text_search_server_ssl_enable: \"true\"\n      css_text_search_server_status: 0\n    ic_css_index_area:\n    - affinity_group_name: <affinity_group_name>\n      index_area_name: os<x>_index_area\n      max_indexes: <int e.g. 20>\n      max_objects_per_index: <int e.g. 10000>\n      object_store_name: <object_store_name>\n      root_dir: /opt/ibm/indexareas\n    ic_enable_cbr:\n    - class_name: Document\n      indexing_languages: en\n      object_store_name: <object_store_name>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Add this to the CR and fill in the items in the angular brackets ",(0,s.jsx)(n.code,{children:"<>"})," above. See tables six, seven and eight of ",(0,s.jsx)(n.a,{href:"https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/23.0.1?topic=parameters-initialization",children:"parameters initialization"})," for more details. What's important here is that all three subsections are included at least once:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ic_css_creation: this creates the content search service"}),"\n",(0,s.jsx)(n.li,{children:"ic_css_index_area: this creates an index area under a specific object store"}),"\n",(0,s.jsx)(n.li,{children:"ic_enable_cbr: this enables content based retreival for the files in the index area"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Finally, ",(0,s.jsx)(n.a,{href:"/Create/Deploy/solution-deploy-operator#apply-the-cr-to-the-cluster",children:"reapply the CR"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"secret-menu-items",children:"Secret menu items"}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsxs)(n.p,{children:["As of ",(0,s.jsx)(n.a,{href:"https://www.ibm.com/support/pages/node/7032026",children:"23.0.1-IF003"})," the secret menu item for disabling readonly root fs on FNCM and BAN components is available. Simply add the following to your CR:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"shared_configuration:\n  sc_disable_read_only_root_filesystem: true\n"})}),(0,s.jsx)(n.p,{children:"This helps when you have agents like Dynatrace that inject certain configs into each container rootfs as they come up."})]})]})}function l(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(_,{...e})}):_(e)}},8378:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/files/ibm_fncm_cr_production-5.5.11-b7b8067dfe02f23e607e71668e85b651.yaml"},1151:(e,n,t)=>{t.d(n,{Z:()=>i,a:()=>o});var s=t(7294);const r={},a=s.createContext(r);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);