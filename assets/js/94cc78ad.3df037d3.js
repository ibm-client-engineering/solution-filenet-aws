"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[901],{4526:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});var i=s(5893),t=s(1151);const c={id:"solution-filenet-event-actions",sidebar_position:3,title:"Event Actions"},l="Event Actions",r={id:"Create/use-cases/solution-filenet-event-actions",title:"Event Actions",description:"Slack Connector",source:"@site/docs/3-Create/use-cases/event_actions.mdx",sourceDirName:"3-Create/use-cases",slug:"/Create/use-cases/solution-filenet-event-actions",permalink:"/solution-filenet-aws/Create/use-cases/solution-filenet-event-actions",draft:!1,unlisted:!1,editUrl:"https://github.com/ibm-client-engineering/solution-filenet-aws/tree/main/packages/create-docusaurus/templates/shared/docs/3-Create/use-cases/event_actions.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"solution-filenet-event-actions",sidebar_position:3,title:"Event Actions"},sidebar:"tutorialSidebar",previous:{title:"Content Replication",permalink:"/solution-filenet-aws/Create/use-cases/solution-filenet-async-replication"},next:{title:"Upgrade",permalink:"/solution-filenet-aws/category/upgrade"}},a={},o=[{value:"Slack Connector",id:"slack-connector",level:2},{value:"Building and Pushing the Image",id:"building-and-pushing-the-image",level:3},{value:"Prerequisites",id:"prerequisites",level:4},{value:"Staging",id:"staging",level:4},{value:"Configure Slack App, Environment Variables",id:"configure-slack-app-environment-variables",level:3},{value:"Slack Setup",id:"slack-setup",level:4},{value:"Environment Variables",id:"environment-variables",level:4},{value:"Installing Event-Driven External Service Extensinons",id:"installing-event-driven-external-service-extensinons",level:3},{value:"Create Event and Subscription",id:"create-event-and-subscription",level:3},{value:"Test the App (Trigger Event Action)",id:"test-the-app-trigger-event-action",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"event-actions",children:"Event Actions"}),"\n",(0,i.jsx)(n.h2,{id:"slack-connector",children:"Slack Connector"}),"\n",(0,i.jsx)(n.h3,{id:"building-and-pushing-the-image",children:"Building and Pushing the Image"}),"\n",(0,i.jsx)(n.h4,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.docker.com/",children:"Docker"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html",children:"AWS CLI"})}),"\n",(0,i.jsxs)(n.li,{children:["A ",(0,i.jsx)(n.a,{href:"https://slack.com/",children:"Slack"})," account with admin access to a workspace"]}),"\n",(0,i.jsxs)(n.li,{children:["Clone the ",(0,i.jsx)(n.a,{href:"https://github.ibm.com/TechnologyGarageUKI/filenet-slack-connector",children:"filenet-slack-connector"})," repo"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"staging",children:"Staging"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Download the slack connector image by running: (or follow repo instructions to build the image w/ Docker)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"curl -O https://publicimages.s3.us-east.cloud-object-storage.appdomain.cloud/slack-connector-ibm.tar.gz"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["For the following steps, refer to ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonECR/latest/userguide/docker-push-ecr-image.html",children:"Pushing a Docker Image (Amazon)"})," as needed"]}),"\n",(0,i.jsxs)(n.li,{children:["Stage the image in your environment. One way to do this is Using ",(0,i.jsx)(n.em,{children:"docker"})," & ",(0,i.jsx)(n.em,{children:"aws cli"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docker import /path/to/exampleimage.tgz"})}),"\n",(0,i.jsxs)(n.li,{children:["Retreive an authentication token & authenticate the docker client to your registry","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"aws ecr get-login-password --region region | docker login --username AWS --password-stdin aws_account_id.dkr.ecr.region.amazonaws.com"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["If you haven't already, ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html#cli-create-repository",children:"create a repository in Amazon ECR"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"aws ecr create-repository \\ --repository-name my-repository \\ --image-scanning-configuration scanOnPush=true \\ --region region"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Tag your image with the Amazon ECR registry","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docker tag <local-image-id> aws_account_id.dkr.ecr.us-west-2.amazonaws.com/my-repository:tag"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Push the image","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"docker push aws_account_id.dkr.ecr.us-west-2.amazonaws.com/my-repository:tag"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"configure-slack-app-environment-variables",children:"Configure Slack App, Environment Variables"}),"\n",(0,i.jsx)(n.h4,{id:"slack-setup",children:"Slack Setup"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://api.slack.com/apps?new_app=1",children:"Navigate"})," to create a new app ",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/631b2d58-abda-4ced-bf89-a72c5a27194d",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Once the app is created, open it (click on it) and go to ",(0,i.jsx)(n.em,{children:"Incoming Webhooks"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/b9c85c5d-d77e-43f2-9b77-56c593155ffb",alt:""}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Activate incoming webhooks:\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/4d194d14-eb67-4870-838e-395c80d045a4",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Add one to your workspace:\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/5fa104a4-432a-4b6b-b2e5-dd07a6043e81",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.em,{children:"OAuth & Permissions"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/f5b84bfd-0a88-4e6d-8779-30c63b841ebc",alt:""}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Copy the ",(0,i.jsx)(n.em,{children:"Bot User OAuth Token"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/f62e6ee6-4145-4857-b484-f8a878a35117",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["On the same page, add OAuth scopes for ",(0,i.jsx)(n.em,{children:"incoming-webhook"}),", ",(0,i.jsxs)(n.em,{children:["chat",":write"]})," and ",(0,i.jsxs)(n.em,{children:["channels",":read"]}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/6d8e90ce-15db-47cd-9260-9ae4cba0566b",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Go to your slack channel and invite the bot to it:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/invite @BOT_NAME"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The yaml files are found under the k8s folder of your project directory","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["secret.yaml","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["paste the bot token into SLACK.TOKEN","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ex: ",(0,i.jsx)(n.code,{children:'SLACK.TOKEN: "xoxb-..."'})," (redacted)"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Ensure the channel name (",(0,i.jsx)(n.em,{children:"SLACK.CHANNEL"}),") matches with what you have in Slack"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["deployment.yaml","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ensure the image points to the image location in ecr:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- name: slack-connector\n    image: >-\n      748107796891.dkr.ecr.us-east-1.amazonaws.com/slack-connector:latest\n    ports:\n      - name: http\n        containerPort: 8080\n        protocol: TCP\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["service.yaml","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ensure the ",(0,i.jsx)(n.em,{children:"ports"})," section is consistent with deployment.yaml and that all names match"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["update the configuration by running ",(0,i.jsx)(n.code,{children:"kubectl apply -f k8s/<>.yaml"})," for each of the yaml files"]}),"\n",(0,i.jsxs)(n.li,{children:["use the updated configuration by deleting the pod","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["run ",(0,i.jsx)(n.code,{children:"kubectl get pod"})," and not the slack connector pod name"]}),"\n",(0,i.jsxs)(n.li,{children:["run ",(0,i.jsx)(n.code,{children:"kubectl delete pod <slack-connector-pod-name>"})]}),"\n",(0,i.jsx)(n.li,{children:"the pod will be brought back with the newly applied config"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"installing-event-driven-external-service-extensinons",children:"Installing Event-Driven External Service Extensinons"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.ibm.com/docs/en/filenet-p8-platform/5.5.x?topic=features-installing-add-feature-object-store",children:"Insall addon"})," ",(0,i.jsx)(n.em,{children:"5.5.4 Event-Driven External Service Invocation Extensions"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"create-event-and-subscription",children:"Create Event and Subscription"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["From the ACCE Console, select and Object Store and navigate to ",(0,i.jsx)(n.em,{children:"Events, Actions, Processes -> Event Actions"})," and create a new Event Action"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/989a8942-173c-4e30-8302-945bb69955b4",alt:""})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Give it a name of your choice and under ",(0,i.jsx)(n.em,{children:"Event Action Type Selection"}),", select ",(0,i.jsx)(n.em,{children:"Webhook"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/6c4386ee-d373-4ace-86a1-d57e9e8b021b",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Under ",(0,i.jsx)(n.em,{children:"Webhook Configurations"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["set ",(0,i.jsx)(n.em,{children:"External Event Receiver URL"})," to be ",(0,i.jsx)(n.code,{children:"http://<image-name>:<port>/slack"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ex: ",(0,i.jsx)(n.code,{children:"http://slack-connector:8080/slack"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["set ",(0,i.jsx)(n.em,{children:"External Event Receiver Registration Identifier"})," to be any name"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.em,{children:"Finish"})," to Create the new Event"]}),"\n",(0,i.jsxs)(n.li,{children:["Under ",(0,i.jsx)(n.em,{children:"Data Design -> Classes -> Document"}),", click on ",(0,i.jsx)(n.em,{children:"Actions -> New Class"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/facf4320-6dca-43fe-b0c9-f573641c52ac",alt:""}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Enter any names you would like and proceed through the final screen (click ",(0,i.jsx)(n.em,{children:"Finish"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.em,{children:"Subscriptions"})," (also under ",(0,i.jsx)(n.em,{children:"Events, Actions, Processes"}),") and create a New Subscription\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/78d1b378-b779-47e8-a058-a784fb72ffac",alt:""}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Under ",(0,i.jsx)(n.em,{children:"Select Classes"}),", choose Document for the Class Type and your newly created class for the ",(0,i.jsx)(n.em,{children:"Class"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/2ab11b5b-876c-43b2-a99f-bef028dfb45e",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["For ",(0,i.jsx)(n.em,{children:"Scope"}),", choose the ",(0,i.jsx)(n.em,{children:"Applies to all objects of this class"})]}),"\n",(0,i.jsxs)(n.li,{children:["Under ",(0,i.jsx)(n.em,{children:"Select the Triggers"}),", select ",(0,i.jsx)(n.em,{children:"Creation Event"})," and ",(0,i.jsx)(n.em,{children:"Update Event"})]}),"\n",(0,i.jsxs)(n.li,{children:["Under ",(0,i.jsx)(n.em,{children:"Select an Event Action"}),", choose the Event Action you created in the previous step"]}),"\n",(0,i.jsxs)(n.li,{children:["Choose default options for the rest and click ",(0,i.jsx)(n.em,{children:"Finish"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"test-the-app-trigger-event-action",children:"Test the App (Trigger Event Action)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["To Trigger the Event Action, Navigate to ",(0,i.jsx)(n.em,{children:"Browse -> Root Folder"})," & create a new document\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/688bd10d-6375-4d70-8066-a8558c111804",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Under ",(0,i.jsx)(n.em,{children:"Define New Document Objects"}),", be sure to select your newly created subclass for the ",(0,i.jsx)(n.em,{children:"Class"}),"\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/e294827e-0b5f-4e77-93f0-962b9f2ebc43",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Select any other options as you wish and click ",(0,i.jsx)(n.em,{children:"Finish"})," to create the document"]}),"\n",(0,i.jsxs)(n.li,{children:["Under the ",(0,i.jsx)(n.em,{children:"Root Folder -> Content"}),", select your newly created document"]}),"\n",(0,i.jsxs)(n.li,{children:["Click on ",(0,i.jsx)(n.em,{children:"Properties"})," and modify one of them, for example, ",(0,i.jsx)(n.em,{children:"Document Title"}),":\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/15db8abe-e0f7-4996-b1a0-91e6b59a87c1",alt:""})]}),"\n",(0,i.jsxs)(n.li,{children:["Open your Slack Channel. You should see the bot posting about the triggered Webhook:\n",(0,i.jsx)(n.img,{src:"https://zenhub.ibm.com/images/649c3ae08710884b790df62c/95235964-fdf0-498e-a3f2-409a7dbf3eb5",alt:""})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>r,a:()=>l});var i=s(7294);const t={},c=i.createContext(t);function l(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);